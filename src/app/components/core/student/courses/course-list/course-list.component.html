<mat-card class="cardWithShadow position-relative overflow-hidden mb-24 h-100">
  <div class="p-24 bg-white">
    @if(!loading) {
    <div class="d-flex align-items-center justify-content-between m-b-24">
      <h6 class="f-s-20 f-w-600">Cursos</h6>
      <div class="flex-grow-1 d-flex d-raw justify-content-end gap-16">
        <form [formGroup]="filtersForm" class="flex-grow-1 d-flex d-raw justify-content-end gap-16">
          <!-- <mat-form-field class="w-80" appearance="outline">
            <mat-label>Convocante</mat-label>
            <input type="text" placeholder="Seleccione organismo convocante" aria-label="Convocante" matInput
              formControlName="callingOrg" [matAutocomplete]="auto" />
            <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
              @for(option of filteredCallingOrgs; track
              option.id) {
              <mat-option [value]="option.description">
                {{ option.description }}
              </mat-option>
              }
            </mat-autocomplete>
          </mat-form-field> -->
          <!-- <mat-form-field class="hide-hint" appearance="outline" [ngClass]="{
                  'w-30': !isMobileView,
                  searchBar: isMobileView
                }">
            <mat-icon matPrefix>search</mat-icon>
            <input matInput placeholder="Buscar curso" formControlName="description"
              (ngModelChange)="filterCourses()" />
            @if(searchText){
            <button matSuffix mat-icon-button aria-label="Clear" (click)="getProductList()">
              <mat-icon>close</mat-icon>
            </button>
            }
          </mat-form-field> -->
          <div class="col-lg-3">
            <mat-form-field appearance="outline" class="w-100 hide-hint">
            <mat-label>Search</mat-label>
            <input matInput (keyup)="applyFilter($event)" />
            <mat-icon matSuffix>
              <i-tabler name="search" class="icon-20 d-flex m-t-2"></i-tabler>
            </mat-icon>
          </mat-form-field>
        </div>
        </form>
      </div>
    </div>
    <!-- TODO: Change to Card 2 -->
    <div class="row justify-content-center">
      @for(course of filteredCourses(); track course.id) {
      <div class="col-sm-6 col-lg-4 p-x-12">
        <mat-card class="cardWithShadow courses overflow-hidden b-1 cursor-pointer" (click)="getCourseDetails(course)">
          <div class="img-wrapper position-relative">
            <img [src]="course.imgSrc" alt="imgSrc" class="w-100" mat-card-image />
            <div class="d-flex align-items-center icon-container">
              <!-- @if( ('COURSE_DELETE' | accessControl) | async ) { -->
              <button mat-mini-fab class="cart-btn-overlay bg-error text-white" matTooltip="Delete" (click)="
                        openDialog(course.id); $event.stopPropagation()
                        ">
                <i-tabler name="trash" class="icon-16 d-flex"></i-tabler>
              </button>
              <!-- } -->
              <!-- @if(('COURSE_EDIT' | accessControl) | async ) { -->
              <button mat-mini-fab class="cart-btn-overlay bg-primary text-white" matTooltip="Edit"
                (click)="getEditedProduct(course)">
                <i-tabler name="pencil" class="icon-16 d-flex"></i-tabler>
              </button>
              <!-- } -->
            </div>
          </div>

          <mat-card-content class="p-b-24 p-t-12 position-relative">
            <mat-card-title class="mat-headline-2 f-s-16 m-b-4 text-ellipsis">
              {{ course.description }}
            </mat-card-title>
            <mat-card-subtitle>
              {{ course.calling_org?.description}}
            </mat-card-subtitle>

            <div class="d-flex align-items-center justify-content-between">
              <div class="d-flex align-items-center">
                <h6 class="f-s-16 f-w-600">{{ course.calling_year }}</h6>
              </div>
              <div class="d-flex align-items-center gap-1">
                @if(course.rating !== undefined){
                @for (star of [1, 2, 3, 4, 5]; track star) {
                <i-tabler name="star" class="icon-17 text-warning"
                  [ngClass]="getStarClass(star, course.rating )"></i-tabler>
                }
                }

              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
      }@empty {
        <app-banner-nof-found bannerText="No hay cursos que cumplan las condiciones de bÃºsqueda." bannerTitle="Ups! Parece que algo ha ido mal."></app-banner-nof-found>
      <!-- <div class="col-12 text-center p-4 m-t-30">
        <img src="assets/images/products/empty-shopping-cart.svg" width="200" height="200" />
        <div class="f-s-48 f-w-600">There is no Product</div>
        <div class="f-s-14 f-w-500">
          The Product you are searching is no longer available.
        </div>
        <button mat-flat-button (click)="getProductList()" class="m-t-10">
          Try Again
        </button>
      </div> -->
      }
    </div>
    } @else {

    <div class="h-100 d-flex align-items-center justify-content-center p-10">
      <mat-spinner></mat-spinner>
    </div>
    }
  </div>
</mat-card>
<!-- <mat-card class="cardWithShadow position-relative overflow-hidden mb-24 h-100">
  <mat-sidenav-container class="email-box">
    <mat-sidenav #mailnav [mode]="isOver() ? 'over' : 'side'" [opened]="!isOver()" class="mail-sidebar">
      <ng-scrollbar class="position-relative" style="height: 100%">
        @if( ('COURSE_CREATE' | accessControl) | async ) {
        <div class="p-16">
          <button mat-flat-button color="primary" class="w-100 btn-block" (click)="getAddProductRoute()">
            Add New Product
          </button>
        </div>
        }
        <h5 class="m-0 p-t-16 p-x-32 f-s-14 f-w-600">Organismo convocante</h5>
        <div class="p-16">
          <mat-nav-list>
            @for(callingOrg of callingOrgs; track callingOrg){
            <mat-list-item role="listitem" class="m-b-2 gap-10 active-primary" [ngClass]="{
                'bg-primary': selectedCallingOrg?.description === callingOrg.description
              }" (click)="getCallingOrg(callingOrg)">
              <span matListItemIcon class="m-r-0">
                <i-tabler name="{{ callingOrg.icon }}" class="icon-18"></i-tabler>
              </span>
              <span matListItemTitle class="f-w-400 f-s-14 text-wrop">{{
                callingOrg.description | titlecase
                }}</span>
            </mat-list-item>
            }
          </mat-nav-list>
        </div>
        <h5 class="m-0 p-t-16 p-x-32 f-s-14 f-w-600 b-t-1">Ordenar por</h5>
        <div class="p-16">
          <mat-nav-list>
            @for (note of notes; track note) {
            <mat-list-item role="listitem" class="m-b-2 gap-10 active-primary"
              [ngClass]="{ 'bg-primary': selectedSortBy === note.name }" (click)="getSorted(note.name)">
              <span matListItemIcon class="m-r-0">
                <i-tabler name="{{ note.icon }}" class="icon-18"></i-tabler>
              </span>
              <span matListItemTitle class="f-w-400 f-s-14">{{
                note.name | titlecase
                }}</span>
            </mat-list-item>
            }
          </mat-nav-list>
        </div>
        <div class="b-t-1 p-20">
          <button mat-flat-button class="w-100 m-y-20" (click)="getRestFilter()">
            Reset Filters
          </button>
        </div>
      </ng-scrollbar>
    </mat-sidenav>
    <mat-sidenav-content>
      <div class="p-24 bg-white">
        @if(!loading) {
        <div class="d-flex align-items-center justify-content-between m-b-24">
          @if(!isMobileView){
          <h6 class="f-s-20 f-w-600">Cursos</h6>
          } @if(isMobileView){
          <button mat-mini-fab class="bg-primary text-white" aria-label="Example icon button with a delete icon"
            (click)="mailnav.toggle()">
            <i-tabler class="icon-18 d-flex" name="menu"></i-tabler>
          </button>
          }

          <div class="flex-grow-1 d-flex d-raw justify-content-end gap-16">
            <form [formGroup]="filtersForm"  class=" d-flex d-raw justify-content-end gap-16">
              <mat-form-field class="w-30" appearance="outline">
                <mat-label>Convocante</mat-label>
                <input type="text" placeholder="Seleccione organismo convocante" aria-label="Convocante" matInput formControlName="callingOrg"
                  [matAutocomplete]="auto" />
                <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete">
                  @for(option of filteredCallingOrgs; track
                  option.id) {
                  <mat-option [value]="option.description">
                    {{ option.description }}
                  </mat-option>
                  }
                </mat-autocomplete>
              </mat-form-field>
              <mat-form-field class="hide-hint" appearance="outline" [ngClass]="{
                  'w-30': !isMobileView,
                  searchBar: isMobileView
                }">
                <mat-icon matPrefix>search</mat-icon>
                <input matInput placeholder="Search Product" formControlName="description" (ngModelChange)="filterCourses()" />
                @if(searchText){
                <button matSuffix mat-icon-button aria-label="Clear" (click)="getProductList()">
                  <mat-icon>close</mat-icon>
                </button>
                }
              </mat-form-field>
            </form>
          </div>
        </div>
        <div class="row">
          @for(course of filteredCourses; track course.id) {
          <div class="col-sm-6 col-lg-4 p-x-12">
            <mat-card class="cardWithShadow courses overflow-hidden b-1 cursor-pointer"
              (click)="getCourseDetails(course)">
              <a routerLink="/widgets/cards">
                <div class="img-wrapper position-relative">
                  <img [src]="course.imgSrc" alt="imgSrc" class="w-100" mat-card-image />
                  <div class="d-flex align-items-center icon-container">
                    @if( ('COURSE_DELETE' | accessControl) | async ) {
                    <button mat-mini-fab class="cart-btn-overlay bg-error text-white" matTooltip="Delete" (click)="
                        openDialog(course.id); $event.stopPropagation()
                        ">
                      <i-tabler name="trash" class="icon-16 d-flex"></i-tabler>
                    </button>
                    }
                    @if(('COURSE_EDIT' | accessControl) | async ) {
                    <button mat-mini-fab class="cart-btn-overlay bg-primary text-white" matTooltip="Edit"
                      (click)="getEditedProduct(course)">
                      <i-tabler name="pencil" class="icon-16 d-flex"></i-tabler>
                    </button>
                    }
                  </div>
                </div>
              </a>

              <mat-card-content class="p-b-24 p-t-12 position-relative">
                <mat-card-title class="mat-headline-2 f-s-16 m-b-4 text-ellipsis">
                  {{ course.description }}
                </mat-card-title>
                <mat-card-subtitle>
                  {{ course.calling_org.description}}
                </mat-card-subtitle>

                <div class="d-flex align-items-center justify-content-between">
                  <div class="d-flex align-items-center">
                    <h6 class="f-s-16 f-w-600">{{ course.calling_year }}</h6>
                  </div>
                  <div class="d-flex align-items-center gap-1">
                    @if(course.rating !== undefined){
                      @for (star of [1, 2, 3, 4, 5]; track star) {
                      <i-tabler name="star" class="icon-17 text-warning"
                        [ngClass]="getStarClass(star, course.rating )"></i-tabler>
                      }
                    }

                  </div>
                </div>
              </mat-card-content>
            </mat-card>
          </div>
          }@empty {
          <div class="col-12 text-center p-4 m-t-30">
            <img src="assets/images/products/empty-shopping-cart.svg" width="200" height="200" />
            <div class="f-s-48 f-w-600">There is no Product</div>
            <div class="f-s-14 f-w-500">
              The Product you are searching is no longer available.
            </div>
            <button mat-flat-button (click)="getProductList()" class="m-t-10">
              Try Again
            </button>
          </div>
          }
        </div>
        } @else {
          <div class="text-center p-5">
            <mat-spinner></mat-spinner>
          </div>
        }
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>
</mat-card> -->